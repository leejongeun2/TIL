✔️ 이번주가 찐막이다. 모델폼 crud 게시판...

✔️이번주 핵심: `회원가입/로그인` - 장고를 통한 인증 시스템

✔️`게시판`과 `회원가입/로그인`은 어떠한 부분이 비슷하면서 어떠한 부분이 다를까?

* 유사: 회원가입 페이지를 만든 경우, 요청이 들어와서 사용자에게 양식 보여주고 그 양식에 사용자가 입력하면 포스트 요청을 받아서 처리
* 다른 점: 



### django auth 개요

* 장고 인증 시스템은 `인증`과 `권한` 부여를 함께 제공하고 있음
* 인증: 로그인
* 권한: 권한 다르게 부여 될 수 있음(스태프, 일반회원 등)
* admin기능에서 superuser을 만듦 : 기본 내장 된 auth
  * user
  * 권한 및 그룹
  * 암호 해시 시스템 => 유저 비밀번호는 디비 저장 시 그대로 저장하면 문제가 발생 됨
  * Form 및 view 도구 => 양식 관련
  * 기타 적용 가능한 시스템
* 필수 구성은 setting.py의 installed_apps에서 확인 가능
  * Django.contrib.admin : 관리자
  * auth : 유저/인증
* 인증
  * 신원확인
  * 사용자가 잣 ㅣㄴ이 누구인지 확인하는 것
* 권한

### 사전설정

* Accounts app 생성 -> setting에서 앱 등록
* url을 분리
  * 해당 앱에 urls 파일 만들기
  * include
  * 만든 ulrs파일에 ulrspatterns 리스트 만들기
  * 앱 네임 설정
    * 왜쓰는지? => 우리는 기본적으로 url을 변수화해서 쓰고 있음(템플릿, 뷰)
    * 그 구조는 app_name과 path의 이름으로 진행하기 때문
* DB 생성/모델 정의
  * Account => models 파일에 모델 정의 
  * 어떠한 필드가 들어가게 될까? => 우리에게 유저 모델은 이미 존재함 => db> auth_user테이블(모델)에 내장되어있어 간편하게 활용 가능
  * 모델을 가져와서 제가 쓸께요 => 클래스 상속! => 임폴트 해서 활용 
  * 공식 문서에서 어떤 필드가 있는지 확인 가능
  * 해당 객체에는 다양한 속성과 다양한 메서드가 있음 
  * 기본 유저 모델이 충분 하더라도 커스텀 유저 모델을 설정하는 것을 강력하게 권장 
    * 왜냐? 커스텀 유저 모델은 기본 유저 모델과 동일하게 작동하면서도 필요한 경우 나중에 맞춤 설정할 수 있기 때문
    * 나중에 바꾸면 어떤 것이 문제가 되냐? 모델을 바꾼다는 것은 데이터 베이스가 변경 되는 것이기 때문에 바꾸려면 어려움
  * Setting.py에서 어쓰 유저 모델 기본 값을 변경해주게 됨
    * auth_user_model =. Accounts.user'
  * 모델은 내부에 있는 모델을 가져와서 바꿀 것임
    * frmo djnago.contrib.auth.models import abstracuser
    * class user(abstractuser):pass
    * 장고 내부에 있는것을 끌어온 것임
    * 앱스트랙 유저는 무엇일까? 
      * ![image-20221011101059517](1011_화.assets/image-20221011101059517.png)

* 비밀번호/인증은 베이스유저
* 일반적은 앱스틱 유저

![image-20221011103300985](1011_화.assets/image-20221011103300985.png)



* 유저 객체 활용

  * 장고 패키지

  

* 유저는 패스워드를 암호화하는 로직자체가 들어가야 됨

  * 암호화 
    * 1234 -> ab123c
  * 암호화는 복호화가 불가능해아함, 단방향 해시함수
  * 항상 1234를 넣을 때마다 ab123c가 나와야함
  * Sha256 알고리즘을 장고에서도 쓰고 있음
    * 레인보우 테이블
      * 대응: 솔팅
      * 패스워드 뒤에 문자열을 붙여주는 것 
    * 무차별
      * 대응: 키스매칭
      * 알고리즘 n회 
  * ![image-20221011104929842](1011_화.assets/image-20221011104929842.png)



### 회원가입 기능 구현

1. Urls 생성
   1. ![image-20221011105406566](1011_화.assets/image-20221011105406566.png)
2. 뷰즈에 사인업 함수 정의 
3. 템플릿 내 회원가입 폼 필요
   1. 뷰즈에서 폼 정의 
   2. 뷰의 흐름은 동일
   3. 어쓰 유저 모델은 어쓰 유저 클래스가 기본 값임 
   4. 기본 모델 자체가 앱 단위로 변경이 된다는 것은 사이드 이펙트를 낼 수 바께 없음
   5. 유저 클래스를 참조하는 방법 빼고 다 똑같음..



### 프로필 디테일 페이지 

Url : /accounts/2 --2번유저

Name: detail

뷰: 디테일

템플릿 반환: 사용자 정보(유저네임)



### 화이트 보드 정리

* user 활용 => 내부적으로 장고 내부 구현되어있음(ex. admin)
  * 인증, 권한까지 내부적으로 구현 되어있음
  * Form&views 함수, 매서드
  * 나도 쓰고, 장고도 쓰고 있음 => 어드민에서 쓰고 있음 (슈퍼유저)
  * **나는 지금 유저 모델을 어카운츠에 있는 유저로 유저 모델을 쓸꺼야 !** 
    * 셋팅파일에 어쓰 유저 모델이라는 것을 만들면서
    * user라는 클래스를 사용하는데, 이것은 abstracter(유저네임, 이메일) 상속받음 이건 abstractbaseuser(비밀번호) 상속 받음
    * 암호화/인증이라는게 복잡한 일이기 때문에 비밀번호 기능만 베이스 유저로 때어놓고 확장
    * 폼즈는 유저 크레이션 폼, 이건 모델폼 상속을 받고 있음
      * **모델 폼은 어떠한 모델의 어떠한 필드를 내가 쓰겠다!관리하겠다!  라는 것임**
      * 클래스 메타 : 모델 = 유저라고 되어있는데 얘는 어쓰의 유저를 의미하는 것이기 때문에 상속 받아서 커스텀함
      * 유저를 참조할 때는 모델에서 꺼내쓰는 것이 아니라 get_user_model()에서 쓰자 ! 이 함수를 통해서 user클래스 참조!! 언제든지 바꿀 수 있으니깐 직접 참조를 하지말자. 
  * 유저 클래스를 가지고 오는 겟 유저 모델, 유저 크레이션 폼 기억!! 
  * Django.contrib.auth의 contrib 의미는?? 
    * 내부에 있는ㄱ ㅓㅅ을 임포트
    * 어드민 기능도 있고, 여러 기능이 있음, 어쓰도 하나의 기능
    * 거기에 어쓰도 있음
    * 컨트립이라는 패키지가 있음, 엑스트라 옵셔널한 툴



### README에 관하여..

* 리드미 작성 필수 !! 



### 실습 

1. 게시글 관리 아티클 앱
2. 사용자 관리 어카운츠 앱
3. 아티클에서 게시글 생성하는 코드 => 1
4. 텍스트필드는 필수아님





비밀번호가 일치하는지 확인하는 함수 내장

유저를 저장할 떄 쓰는 메서드들도 있음

유저 객체를 활용할대는 항상 상속 받아서 활용하면 기능 사용 가능





폼제공해야함 

회원가입에 필요한 폼 제공되어야함

회원가입 폼은 저 밑에서 끄집어낼수 있음 => 모델폼이 필요함

유저와 연결 된 모델폼이 필요 



Manager 은 orm에서 models.model을 상속받는 이유이기도함? 

=> Article(objects)가 매니저를 통해 동작

=> 어카운트 유저로 바꾸지 않았냐..





친절상속받는이유?

=> 비밀번호 직접할것인가?

모델폼만들면 모델폼 어딘가에 로직이 들어가야함

일상적 단어/둘다 같지 않은것 등의 로직을 구현해줌





폼즈 파일의 유저모델 자체는 일반적으로 변경이 언제든지 가능한 모델, 상속받아서 만들었지만 기본은 auth_user_model임









